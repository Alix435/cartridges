<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—á—ë—Ç –∫–∞—Ä—Ç—Ä–∏–¥–∂–µ–π</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<!-- Flash-—Å–æ–æ–±—â–µ–Ω–∏—è -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="flash-messages flash-{{ category }}">{{ message }}</div>
    {% endfor %}
    <script>
      setTimeout(() => {
        const el = document.querySelector('.flash-messages');
        if (el) {
          el.style.opacity = '0';
          setTimeout(() => el.remove(), 300);
        }
      }, 3000);
    </script>
  {% endif %}
{% endwith %}

<!-- –ú–µ–Ω—é –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É -->
<div class="top-nav">
    <a href="/" title="–ù–∞ –≥–ª–∞–≤–Ω—É—é">üñ®Ô∏è –ú–µ–Ω—é</a>
    <a href="/export" title="–ù–∞ –≥–ª–∞–≤–Ω—É—é">Excel</a>
</div>

<!-- –°–µ—Ç–∫–∞ –±–ª–æ–∫–æ–≤ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ -->
<div class="printers-grid">
    {% if grouped_cartridges %}
        {% for printer_model, cartridges in grouped_cartridges.items() %}
        <div class="printer-block">
            <h3 class="printer-title">{{ printer_model }}</h3>
            <table class="cartridge-table">
                <thead>
                    <tr>
                        <th>–¶–≤–µ—Ç</th>
                        <th>–ú–æ–¥–µ–ª—å</th>
                        <th>–ö–æ–ª-–≤–æ</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for c in cartridges %}
                    <tr>
                        <td>{{ c.color_name|capitalize }}</td>
                        <td>{{ c.model_code or '‚Äî' }}</td>
                        <td>
                            {{ (c.quantity or 0) }}
                            <!-- –ö–Ω–æ–ø–∫–∞ —Å–ø–∏—Å–∞–Ω–∏—è -1 -->
                            <form method="POST" action="{{ url_for('cartridges_page') }}" style="display:inline;">
                                <input type="hidden" name="id" value="{{ c.id }}">
                                <input type="hidden" name="action" value="decrement">
                                <button type="submit" class="btn-dec"
                                        {% if (c.quantity or 0) <= 0 %}disabled{% endif %}
                                        title="–°–ø–∏—Å–∞—Ç—å 1 —à—Ç.">‚àí</button>
                            </form>
                        </td>
                        <td>
                            <!-- –ö–Ω–æ–ø–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
                            <a href="{{ url_for('edit_cartridge', cartridge_id=c.id) }}"
                               class="btn-edit" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endfor %}
    {% else %}
        <div class="empty-state">
            <h2>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</h2>
            <p>–î–æ–±–∞–≤—å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–∏–Ω—Ç–µ—Ä–∞—Ö –∏ –∫–∞—Ä—Ç—Ä–∏–¥–∂–∞—Ö.</p>
        </div>
    {% endif %}
</div>

</body>
</html>
